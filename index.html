
<input id="first_name" placeholder = "first name" />
<input id="last_name" placeholder = "last name" />
<input id="phone_number" placeholder = "phone number" />
<input id="email" placeholder = "email" />
<button id="add_button">Add new contact</button>


<ul id="contacts"></ul>
<script>
var container = document.getElementById("contacts");
var addContactButton = document.getElementById("add_button");
var firstNameInput = document.getElementById("first_name");
var lastNameInput = document.getElementById("last_name");
var phoneNumberInput = document.getElementById("phone_number");
var emailInput = document.getElementById("email");
var inputs = document.getElementsByTagName("input");

updateContactList();
addContactButton.addEventListener("click", addNewContact);

function addNewContact() {
    var contact = {
        firstName: firstNameInput.value,
        lastName: lastNameInput.value,
        phoneNumber: phoneNumberInput.value,
        email: emailInput.value
    };

    fetch("http://localhost:3000/contacts", {
        method: 'POST',
        body: JSON.stringify(contact),
        headers: {
            'Content-Type': 'application/json'
        }
    }).then(updateContactList);
    clearInputs();
}

function clearInputs() {
    var inputNode = Array.from(inputs);
    inputNode.forEach(function (input) {
        input.value = "";
    })
}

function deleteContact(contactId) {
    fetch("http://localhost:3000/contacts/" + contactId, {
        method:"DELETE",
        headers: {
            'Content-Type': 'application/json'
        }
    }).then(updateContactList)
}

function getContactList() {
    return fetch("http://localhost:3000/contacts")
        .then(function (response) {
            return response.json()
        }
    )
}

function displayContactList(contacts) {
    container.innerText = "";
    contacts.forEach (function (contact) {
        var listNode = document.createElement("li");
        var editBtn = document.createElement("button");
            editBtn.innerText = "Edit";
        var deleteBtn = document.createElement("button");
            deleteBtn.innerText = "Delete contact";
            deleteBtn.addEventListener("click", function () {
                deleteContact(contact.id)
            });
            listNode.innerText = contact.firstName + " " + contact.lastName + " " + contact.phoneNumber + " " + contact.email;
            container.appendChild(listNode);
            listNode.appendChild(editBtn);
            listNode.appendChild(deleteBtn);
    })
}

function updateContactList() {
    getContactList().then(displayContactList)
}

</script>